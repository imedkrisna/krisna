---
title: "Exchange rate II: the asset approach in the short run"
subtitle: "ECES905205 pertemuan 4"
date: "12 September 2024"
author: "I Made Krisna Gupta"
format: 
  revealjs:
    theme: [simple,../mytheme.scss]
    chalkboard: true
    incremental: false
    transition: convex
    background-transition: fade
    slide-number: true
  beamer:
    latex-tinytex: true
    latex-auto-install: true
  pptx: default
---

```{r}
library(tidyverse)
library(kableExtra)
graph<-function(dataset, ...) {
  dataset |>
  ggplot(aes(...))+
  theme_classic() +
  theme(panel.background = element_rect(fill = "#f0f1eb",
                                        colour = "#f0f1eb"),
        plot.margin = margin(0,0,0,0),
        plot.background = element_rect(fill = "#f0f1eb"),
        legend.key = element_rect(fill = "#f0f1eb",linetype = "blank"),
        legend.background = element_rect(fill="#f0f1eb"))
}
graph3<-theme_classic() +
  theme(panel.background = element_rect(fill = "#f0f1eb",
                                        colour = "#f0f1eb"),
        plot.margin = margin(0,0,0,0),
        plot.background = element_rect(fill = "#f0f1eb"),
        axis.title.x = element_text(hjust=1),
        axis.title.y = element_text(angle=0,hjust=1,vjust=1),
        legend.key = element_rect(fill = "#f0f1eb",linetype = "blank"),
        legend.background = element_rect(fill="#f0f1eb"))
graph2<-theme_classic() +
  theme(panel.background = element_rect(fill = "#f0f1eb",
                                        colour = "#f0f1eb"),
        plot.margin = margin(0,0,0,0),
        plot.background = element_rect(fill = "#f0f1eb"),
        legend.key = element_rect(fill = "#f0f1eb",linetype = "blank"),
        legend.background = element_rect(fill="#f0f1eb"),
        axis.title.x = element_text(hjust=1),
        axis.title.y = element_text(angle=0,hjust=1,vjust=1),
        panel.grid=element_blank(),
        axis.text.x=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.x=element_blank(),
        axis.ticks.y=element_blank(),
        legend.position=c(1,1),
        legend.justification = c(1,1),
        legend.spacing=unit(0,"cm"),
        legend.margin=margin(0,0,0,0))
```

## Overview

- How the arbitrage in the short-run plays out the dynamics of exchange rate?

- How do money market and central bank policy choices determines interest rate?

- What can the theory of exchange rates tell us about the difference between floating and fixed XR?

## Intro {.m}

- Deviations from purchasing power parity (PPP) occur in the short run: The same basket of goods generally does not cost the same everywhere at all times.

- Short-run failures of the monetary approach led economists to develop an alternative theory to explain exchange rates in the short run: the asset approach to exchange rates.

- It is called the asset approach because it is based on the idea that currencies are assets (i.e., stores of value).

- The price of the asset in this case is the spot exchange rate, the price of one unit of foreign exchange.

## Risky arbitrage

- The Uncovered Interest Parity (UIP) equation is the fundamental equation of the asset approach to exchange rates.

\begin{equation}
i_{Rp}=i_\$+\frac{E^e_{Rp/\$}-E_{Rp/\$}}{E_{Rp/\$}}
\end{equation}

the left-hand side is the rupiah return on rupiah asset while the right-hand side is the expected rupiah return on dollar asset.

## Example {.m}

```{r}

dat<-tibble(
  iRp=rep(0.05,5),
  iD=rep(0.03,5),
  spot=c(15000,15300,15392,15600,15800),
  e=rep(15700,5)
  
)

dat$ee<-(dat$e-dat$spot)/dat$spot
dat$fore<-dat$ee+dat$iD

kbl(dat)|>
  kable_styling("striped", full_width = F,position = "center")|>
  row_spec(3, bold = T, color = "white", background = "blue")
```

where ee is the expected depreciation of rupiah while fore is the expected rupiah return on dollar asset. Any spot higher than 15392 will create an opportunity to hold dollar asset, while the opposite is true for spot lower than 15392.

## Money market

```{r}
graph(dat)+geom_line(aes(x=spot,y=fore),color="blue",linewidth=1.1)+
  geom_point(aes(x=spot,y=fore),size=2)+
  geom_hline(yintercept = 0.05,color="red",linewidth=1.1)+
  labs(title="Money market",
       x="Spot exchange rate",
       y="Expected rupiah return")
```

Blue line shows the rupiah return on dollar asset while the red line is the rupiah return on rupiah asset. Intersection is the equilibrium. Any point above red line is a case for holding dollar asset.

## FX market movement

Using framework above, lets see what happens under these following scenarios:

1. A higher domestic interest rate of 7%

2. A lower foreign rate of 1%

3. A lower expected future exchange rate $E^e_{Rp/\$}=15600$ which is an appreciation.

## Case 1 {.m}

:::: columns
::: {.column width=50%}

```{r}
#| fig-width: 5
#| fig-height: 4

graph(dat)+geom_line(aes(x=spot,y=fore),color="blue",linewidth=1.1)+
  geom_point(aes(x=spot,y=fore),size=2)+
  geom_hline(yintercept = 0.05,color="red",linewidth=1.1,linetype="dashed")+
  geom_hline(yintercept = 0.07,color="red",linewidth=1.1)+
  labs(title="Money market",
       x="Spot exchange rate (Rp/$)",
       y="Expected rupiah return")
```

:::
::: {.column width=50%}
An increase in domestic interest rate rises our red line. When interest rate goes up, it is now better to hold Indonesian asset. Rupiah demand went up which means an appreciation of the local currency against the dollar, up until the UIP holds.
:::
::::

## Case 2 {.m}
:::: columns
::: {.column width=50%}

```{r}
#| fig-width: 5
#| fig-height: 4

dat$iDD<-rep(0.01,5)
dat$e2<-rep(15600,5)

dat$ee3<-(dat$e2-dat$spot)/dat$spot
dat$fore2<-dat$ee+dat$iDD
dat$fore3<-dat$ee3+dat$iD

graph(dat)+geom_line(aes(x=spot,y=fore2),color="blue",linewidth=1.1)+
  geom_point(aes(x=spot,y=fore2),size=2)+
  geom_hline(yintercept = 0.05,color="red",linewidth=1.1)+
  geom_line(aes(x=spot,y=fore),color="blue",linetype="dashed")+
  labs(title="Money market",
       x="Spot exchange rate",
       y="Expected rupiah return")
```

:::
::: {.column width=50%}
Under the second case, decrease in foreign interest rate leads to changes in the right-hand side equation (rupiah return in dollar asset) which affects the blue line. Decrease in foreign interest rate decreases the rupiah return in dollar asset. The blue line shifts downward, and equilibrium shifts to lower E which means an appreciation to IDR.
:::
::::

## Case 3 {.m}

:::: columns
::: {.column width=50%}

```{r}
#| fig-width: 5
#| fig-height: 4
dat$iDD<-rep(0.01,5)
dat$e2<-rep(15600,5)

graph(dat)+geom_line(aes(x=spot,y=fore3),color="blue",linewidth=1.1)+
  geom_point(aes(x=spot,y=fore3),size=2)+
  geom_hline(yintercept = 0.05,color="red",linewidth=1.1)+
  geom_line(aes(x=spot,y=fore),color="blue",linetype="dashed")+
  labs(title="Money market",
       x="Spot exchange rate",
       y="Expected rupiah return")
```

:::
::: {.column width=50% .incremental}
When expectation of the future rate is a lower spot rate (an appreciation of IDR), it affects the return in dollar asset. The blue line shifts downward, leading to more opportunity to hold rupiah asset. equilibrium spot rate is shifting down, leading to an appreciation of IDR.
:::
::::

## Short run equilibrium

- In the short run, the price level is sticky, it is predetermined or known variable fixed at $P=\bar{P}$

- In the short run, the nominal interest rate $i$ is fully flexible and adjusts to bring the money market to equilibrium.

Sticky prices assumption, also called *nominal rigidity*, is very common in the study of macroeconomics in the short run.

## Short run equilibrium

The expressions for money market equilibrium in two countries are as follows:

\begin{equation}
\frac{M_{ID}}{\bar{P}_{ID}}=L(i_{Rp}) \times Y_{ID} \\
\frac{M_{US}}{\bar{P}_{US}}=L(i_{\$}) \times Y_{US}
\end{equation}

Remember, money supply is controlled by the central bank.

## Short run equilibrium {.m}

:::: columns
::: {.column width=47%}

```{r}
#| fig-width: 5
#| fig-height: 4
x=40
y=15.625
demand<-function(q) (q/100)^(-3)
ggplot()+stat_function(fun=demand,linewidth=1.1,color="blue")+
  scale_x_continuous(limits=c(25,50),breaks = 40, expand = c(0,0),
                     labels = expression(frac(M[ID]^1,P[ID]^1))) +
  scale_y_continuous(limits=c(0,50),breaks = 15.625,expand = c(0,0),
                     labels=expression(i[Rp]^1))+
  geom_vline(xintercept=40,color="red",linewidth=1.1)+
  geom_point(x=40,y=15.625)+
  annotate("segment",x=25,y=y,xend=x,yend = y,linetype="dotted")+
  annotate("segment",x=x,y=0,xend=x,yend = y,linetype="dotted")+
  
  labs(x="Real Money\nBalance (M/P)",
       y="nominal\ninterest\nrate (i)")+
  graph3

```

:::
::: {.column width=47%}

The mney supply curve (red line) is vertical because it does not depends on domestic interest rate. Money demand curve (blue line) is downward sloping amid interest rate increase leads to lower money demand.

The money market equilibrium is at $i^1_{Rp}$ because it is where demand equals supply. 

:::
::::

## Short run equilibrium {.m}

:::: columns
::: {.column width=47%}

```{r}
#| fig-width: 5
#| fig-height: 4
x=40
y=15.625
demand<-function(q) (q/100)^(-3)
ggplot()+stat_function(fun=demand,linewidth=1.1,color="blue")+
  scale_x_continuous(limits=c(25,50),breaks = 40, expand = c(0,0),
                     labels = expression(frac(M[ID]^1,P[ID]^1))) +
  scale_y_continuous(limits=c(0,50),breaks = 15.625,expand = c(0,0),
                     labels=expression(i[Rp]^1))+
  geom_vline(xintercept=40,color="red",linewidth=1.1)+
  geom_point(x=40,y=15.625)+
  annotate("segment",x=25,y=y,xend=x,yend = y,linetype="dotted")+
  annotate("segment",x=x,y=0,xend=x,yend = y,linetype="dotted")+
  
  labs(x="Real Money\nBalance (M/P)",
       y="nominal\ninterest\nrate (i)")+
  graph3

```

:::
::: {.column width=47%}

With a fixed price level $P_{ID}^1$, an increase in nominal money supply from $M^1_{ID}$ to $M^2_{ID}$ will increase real money supply from $\frac{M^1_{ID}}{P_{ID}^1}$ to $\frac{M^2_{ID}}{P_{ID}^1}$

:::
::::

## Short run equilibrium {.m}

:::: columns
::: {.column width=47%}

```{r}
#| fig-width: 5
#| fig-height: 4
x=40
y=15.625
demand<-function(q) (q/100)^(-3)
ggplot()+stat_function(fun=demand,linewidth=1.1,color="blue")+
  scale_x_continuous(limits=c(25,50),breaks = 40, expand = c(0,0),
                     labels = expression(frac(M[ID]^1,P[ID]^1))) +
  scale_y_continuous(limits=c(0,50),breaks = 15.625,expand = c(0,0),
                     labels=expression(i[Rp]^1))+
  geom_vline(xintercept=40,color="red",linewidth=1.1)+
  geom_point(x=40,y=15.625)+
  annotate("segment",x=25,y=y,xend=x,yend = y,linetype="dotted")+
  annotate("segment",x=x,y=0,xend=x,yend = y,linetype="dotted")+
  
  labs(x="Real Money\nBalance (M/P)",
       y="nominal\ninterest\nrate (i)")+
  graph3

```

:::
::: {.column width=47%}

The mney supply curve (red line) is vertical because it does not depends on domestic interest rate. Money demand curve (blue line) is downward sloping amid interest rate increase leads to lower money demand.

The money market equilibrium is at $i^1_{Rp}$ because it is where demand equals supply. 

:::
::::